<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Homi - Owner Dashboard</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/dashboardowner.css">

  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full w-full">
  <div class="dashboard-wrapper"><!-- Header -->
   <header class="dashboard-header">
    <div class="header-inner">
     <div class="header-left">
      <h1 class="dashboard-title dashboard-title-text">Owner Dashboard</h1>
      <p class="dashboard-subtitle dashboard-subtitle-text">Monitor your home service operations</p>
     </div>
     <div class="header-actions"><button class="icon-button" aria-label="Notifications">
       <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" /> <path d="M13.73 21a2 2 0 0 1-3.46 0" />
       </svg><span class="notification-badge"></span> </button> <button class="icon-button" aria-label="Settings">
       <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3" /> <path d="M12 1v6m0 6v6m8.66-13.66-4.24 4.24M9.17 14.83l-4.24 4.24M23 12h-6m-6 0H1m18.66 8.66-4.24-4.24M9.17 9.17L4.93 4.93" />
       </svg></button>
      <div class="user-avatar">
       O
      </div>
     </div>
    </div>
   </header><!-- Main Content -->
   <main class="dashboard-main">
    <div class="dashboard-grid"><!-- StatCard 1: Active Executors -->
     <article class="dashboard-card stat-card" style="--icon-color-1: #3b82f6; --icon-color-2: #2563eb;">
      <div class="card-header">
       <h2 class="card-title active-executors-label-text">Active Executors</h2>
       <div class="card-icon">
        <svg width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" /> <circle cx="9" cy="7" r="4" /> <path d="M23 21v-2a4 4 0 0 0-3-3.87" /> <path d="M16 3.13a4 4 0 0 1 0 7.75" />
        </svg>
       </div>
      </div>
      <div class="stat-value">
       24
      </div>
      <div class="stat-label">
       Currently Working
      </div><span class="stat-trend positive">
       <svg width="14" height="14" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15" />
       </svg> +18% from last week </span>
     </article><!-- StatCard 2: Completion Rate -->
     <article class="dashboard-card stat-card" style="--icon-color-1: #16a34a; --icon-color-2: #15803d;">
      <div class="card-header">
       <h2 class="card-title completion-rate-label-text">Completion Rate</h2>
       <div class="card-icon">
        <svg width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" /> <polyline points="22 4 12 14.01 9 11.01" />
        </svg>
       </div>
      </div>
      <div class="stat-value">
       94%
      </div>
      <div class="stat-label">
       Tasks Completed
      </div><span class="stat-trend positive">
       <svg width="14" height="14" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15" />
       </svg> +4% from last month </span>
     </article><!-- StatCard 3: Total Revenue -->
     <article class="dashboard-card stat-card" style="--icon-color-1: #8b5cf6; --icon-color-2: #7c3aed;">
      <div class="card-header">
       <h2 class="card-title revenue-label-text">Total Revenue</h2>
       <div class="card-icon">
        <svg width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23" /> <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />
        </svg>
       </div>
      </div>
      <div class="stat-value">
       $48.2K
      </div>
      <div class="stat-label">
       This Month
      </div><span class="stat-trend positive">
       <svg width="14" height="14" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15" />
       </svg> +22% from last month </span>
     </article><!-- Chart Card: Executor Workload -->
     <article class="dashboard-card col-span-2">
      <div class="card-header">
       <h2 class="card-title">Executor Workload Distribution</h2><button class="icon-button" aria-label="More options">
        <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1" /> <circle cx="12" cy="5" r="1" /> <circle cx="12" cy="19" r="1" />
        </svg></button>
      </div>
      <div class="chart-container">
       <div class="bar-chart" id="workloadChart"><!-- Bars will be rendered here -->
       </div>
      </div>
     </article><!-- Payment Estimation Card -->
     <article class="dashboard-card">
      <div class="card-header">
       <h2 class="card-title">Payment Estimation</h2><button class="icon-button" aria-label="More options">
        <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1" /> <circle cx="12" cy="5" r="1" /> <circle cx="12" cy="19" r="1" />
        </svg></button>
      </div>
      <div>
       <div class="progress-item">
        <div class="progress-header"><span class="progress-label">Completed Tasks</span> <span class="progress-value">$32,500</span>
        </div>
        <div class="progress-bar-bg">
         <div class="progress-bar-fill" style="width: 75%; --progress-color-1: #16a34a; --progress-color-2: #15803d;"></div>
        </div>
       </div>
       <div class="progress-item">
        <div class="progress-header"><span class="progress-label">In Progress</span> <span class="progress-value">$12,800</span>
        </div>
        <div class="progress-bar-bg">
         <div class="progress-bar-fill" style="width: 55%; --progress-color-1: #3b82f6; --progress-color-2: #2563eb;"></div>
        </div>
       </div>
       <div class="progress-item">
        <div class="progress-header"><span class="progress-label">Pending Review</span> <span class="progress-value">$2,900</span>
        </div>
        <div class="progress-bar-bg">
         <div class="progress-bar-fill" style="width: 30%; --progress-color-1: #f59e0b; --progress-color-2: #d97706;"></div>
        </div>
       </div>
      </div>
     </article><!-- Task Distribution Card -->
     <article class="dashboard-card col-span-3">
      <div class="card-header">
       <h2 class="card-title">Recent Task Activity</h2><button class="icon-button" aria-label="View all">
        <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6" />
        </svg></button>
      </div>
      <div class="task-list" id="taskList"><!-- Task items will be rendered here -->
      </div>
     </article>
    </div>
   </main>
  </div>
  <script>
    // Sample data for executor workload chart
    const workloadData = [
      { name: 'John', tasks: 12, color1: '#3b82f6', color2: '#2563eb' },
      { name: 'Sarah', tasks: 18, color1: '#8b5cf6', color2: '#7c3aed' },
      { name: 'Mike', tasks: 8, color1: '#16a34a', color2: '#15803d' },
      { name: 'Emma', tasks: 15, color1: '#f59e0b', color2: '#d97706' },
      { name: 'Alex', tasks: 10, color1: '#ef4444', color2: '#dc2626' }
    ];

    // Sample task data
    const recentTasks = [
      { name: 'Kitchen Deep Clean', executor: 'John Smith', status: 'completed' },
      { name: 'Lawn Maintenance', executor: 'Sarah Johnson', status: 'in-progress' },
      { name: 'Window Washing', executor: 'Mike Davis', status: 'completed' },
      { name: 'Bathroom Renovation', executor: 'Emma Wilson', status: 'in-progress' },
      { name: 'Garage Organization', executor: 'Alex Brown', status: 'pending' }
    ];

    // Render workload bar chart
    function renderWorkloadChart() {
      const chartContainer = document.getElementById('workloadChart');
      const maxTasks = Math.max(...workloadData.map(d => d.tasks));
      
      chartContainer.innerHTML = workloadData.map(executor => {
        const heightPercent = (executor.tasks / maxTasks) * 100;
        return `
          <div class="bar-wrapper">
            <div class="bar-container">
              <div class="bar" 
                   style="height: ${heightPercent}%; --bar-color-1: ${executor.color1}; --bar-color-2: ${executor.color2};">
                <div class="bar-value">${executor.tasks} tasks</div>
              </div>
            </div>
            <div class="bar-label">${executor.name}</div>
          </div>
        `;
      }).join('');
    }

    // Render task list
    function renderTaskList() {
      const taskContainer = document.getElementById('taskList');
      
      taskContainer.innerHTML = recentTasks.map(task => {
        const statusClass = task.status.replace('-', '');
        const statusText = task.status.replace('-', ' ');
        return `
          <div class="task-item">
            <div class="task-info">
              <div class="task-name">${task.name}</div>
              <div class="task-meta">Assigned to ${task.executor}</div>
            </div>
            <span class="task-badge ${statusClass}">${statusText}</span>
          </div>
        `;
      }).join('');
    }

    // Config and SDK
    const defaultConfig = {
      background_gradient_start: '#f0f9ff',
      background_gradient_middle: '#e0f2fe',
      background_gradient_end: '#ede9fe',
      surface_color: '#ffffff',
      text_color: '#0f172a',
      dashboard_title: 'Owner Dashboard',
      dashboard_subtitle: 'Monitor your home service operations',
      active_executors_label: 'Active Executors',
      completion_rate_label: 'Completion Rate',
      revenue_label: 'Total Revenue',
      font_family: 'Inter',
      font_size: 16
    };

    async function onConfigChange(config) {
      const customFont = config.font_family || defaultConfig.font_family;
      const baseSize = config.font_size || defaultConfig.font_size;
      const baseFontStack = 'system-ui, -apple-system, BlinkMacSystemFont, sans-serif';
      
      document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;

      // Update dashboard title
      document.querySelector('.dashboard-title-text').textContent = config.dashboard_title || defaultConfig.dashboard_title;

      // Update dashboard subtitle
      document.querySelector('.dashboard-subtitle-text').textContent = config.dashboard_subtitle || defaultConfig.dashboard_subtitle;

      // Update metric labels
      document.querySelector('.active-executors-label-text').textContent = config.active_executors_label || defaultConfig.active_executors_label;
      document.querySelector('.completion-rate-label-text').textContent = config.completion_rate_label || defaultConfig.completion_rate_label;
      document.querySelector('.revenue-label-text').textContent = config.revenue_label || defaultConfig.revenue_label;

      // Update font sizes
      document.querySelector('.dashboard-title').style.fontSize = `${baseSize * 1.75}px`;
      document.querySelector('.dashboard-subtitle').style.fontSize = `${baseSize * 0.875}px`;
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_gradient_start || defaultConfig.background_gradient_start,
              set: (value) => {
                config.background_gradient_start = value;
                window.elementSdk.setConfig({ background_gradient_start: value });
              }
            },
            {
              get: () => config.background_gradient_end || defaultConfig.background_gradient_end,
              set: (value) => {
                config.background_gradient_end = value;
                window.elementSdk.setConfig({ background_gradient_end: value });
              }
            },
            {
              get: () => config.surface_color || defaultConfig.surface_color,
              set: (value) => {
                config.surface_color = value;
                window.elementSdk.setConfig({ surface_color: value });
              }
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => {
                config.text_color = value;
                window.elementSdk.setConfig({ text_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => config.font_family || defaultConfig.font_family,
            set: (value) => {
              config.font_family = value;
              window.elementSdk.setConfig({ font_family: value });
            }
          },
          fontSizeable: {
            get: () => config.font_size || defaultConfig.font_size,
            set: (value) => {
              config.font_size = value;
              window.elementSdk.setConfig({ font_size: value });
            }
          }
        }),
        mapToEditPanelValues: (config) => new Map([
          ['dashboard_title', config.dashboard_title || defaultConfig.dashboard_title],
          ['dashboard_subtitle', config.dashboard_subtitle || defaultConfig.dashboard_subtitle],
          ['active_executors_label', config.active_executors_label || defaultConfig.active_executors_label],
          ['completion_rate_label', config.completion_rate_label || defaultConfig.completion_rate_label],
          ['revenue_label', config.revenue_label || defaultConfig.revenue_label]
        ])
      });
    }

    // Initialize
    onConfigChange(defaultConfig);
    renderWorkloadChart();
    renderTaskList();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9b064098a40b13f4',t:'MTc2NjE0MDUxNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>